<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Etiquetas | Sistema Interno</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Roboto+Mono:wght@500&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        /* --- CONFIGURAÇÕES GERAIS --- */
        :root {
            --gov-blue: #1351b4;
            --gov-blue-dark: #0c326f;
            --bg-body: #f8f8f8;
            --border-color: #e5e5e5;
            --text-primary: #131313;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; outline: none; }
        
        body {
            font-family: 'Roboto', Arial, sans-serif;
            background-color: var(--bg-body);
            color: var(--text-primary);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* --- HEADER & FOOTER --- */
        .br-header { background: var(--gov-blue); color: white; padding: 8px 0; border-bottom: 4px solid var(--gov-blue-dark); }
        .header-container { max-width: 1400px; margin: 0 auto; padding: 0 20px; font-weight: 700; font-size: 16px; text-transform: uppercase; }
        .br-footer { background: var(--gov-blue-dark); color: white; padding: 15px 0; font-size: 12px; margin-top: auto; text-align: center; }

        /* --- LAYOUT PRINCIPAL --- */
        .main-container {
            max-width: 1400px; margin: 30px auto; padding: 0 20px; width: 100%;
            display: grid; grid-template-columns: 380px 1fr; gap: 30px; align-items: start;
        }

        /* --- PAINEL DE CONTROLE --- */
        .control-panel {
            background: white; border: 1px solid var(--border-color); border-radius: 4px; padding: 25px;
            position: sticky; top: 20px; max-height: calc(100vh - 40px); overflow-y: auto;
        }

        .panel-title { font-size: 18px; font-weight: 700; color: var(--gov-blue); margin-bottom: 20px; border-bottom: 2px solid var(--gov-blue); padding-bottom: 10px; }

        /* Inputs */
        .form-group { margin-bottom: 12px; position: relative; }
        .form-label { display: block; font-size: 11px; font-weight: 700; color: #555; margin-bottom: 4px; text-transform: uppercase; }
        .form-control {
            width: 100%; padding: 8px 10px; border: 1px solid #ccc; border-radius: 4px;
            font-size: 13px; font-family: inherit; transition: border-color 0.2s;
        }
        .form-control:focus { border-color: var(--gov-blue); }
        .row-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }

        /* Autocomplete */
        .autocomplete-list {
            position: absolute; top: 100%; left: 0; right: 0; background: white;
            border: 1px solid #ccc; max-height: 150px; overflow-y: auto; z-index: 100; display: none;
        }
        .autocomplete-item { padding: 8px; font-size: 12px; cursor: pointer; border-bottom: 1px solid #f0f0f0; }
        .autocomplete-item:hover { background: #f2f7fd; color: var(--gov-blue); }

        /* Botões */
        .btn {
            width: 100%; padding: 12px; border-radius: 4px; font-size: 13px; font-weight: 600; cursor: pointer;
            border: none; display: flex; align-items: center; justify-content: center; gap: 8px; text-transform: uppercase; margin-top: 10px;
        }
        .btn-primary { background: var(--gov-blue); color: white; }
        .btn-primary:hover { background: var(--gov-blue-dark); }
        .btn-outline { background: transparent; border: 1px solid #ccc; color: #555; }
        .btn-success { background: #168821; color: white; margin-top: 20px; }

        /* --- MODE SWITCHER --- */
        .mode-switcher { display: flex; gap: 10px; margin-bottom: 20px; background: #f0f0f0; padding: 5px; border-radius: 4px; }
        .mode-btn { flex: 1; border: none; padding: 8px; font-size: 12px; font-weight: 700; cursor: pointer; background: transparent; border-radius: 4px; }
        .mode-btn.active { background: var(--gov-blue); color: white; }

        /* --- PREVIEW ÁREA --- */
        .preview-area {
            background: #e0e0e0; border: 1px solid #ccc; border-radius: 4px; padding: 40px;
            display: flex; justify-content: center; min-height: 600px;
        }
        .sheet-a4 {
            width: 210mm; min-height: 297mm; background: white; padding: 10mm;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: repeat(3, 1fr);
            gap: 5mm; box-sizing: border-box;
        }

        /* --- ESTILOS DAS ETIQUETAS --- */
        .etiqueta-box {
            border: 1px dashed #ddd; /* Tracejado na tela */
            height: 100%; padding: 0; position: relative; background: white;
            display: flex; flex-direction: column; overflow: hidden;
        }
        .btn-delete {
            position: absolute; top: -10px; right: -10px; background: #cc0000; color: white;
            border: none; width: 24px; height: 24px; border-radius: 50%; cursor: pointer;
            font-size: 12px; z-index: 20; display: flex; align-items: center; justify-content: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        /* === LAYOUT DE ELIMINAÇÃO (FORMULÁRIO COM GRIDS) === */
        .layout-eliminacao {
            width: 100%; height: 100%;
            border: 2px solid #000;
            display: grid;
            grid-template-rows: auto auto auto auto auto 1fr auto; /* Linhas definidas */
            font-family: Arial, sans-serif;
            color: #000;
        }

        .eli-row {
            display: flex;
            border-bottom: 1px solid #000;
            min-height: 28px;
        }

        .eli-cell {
            padding: 4px 6px;
            display: flex;
            align-items: baseline;
            gap: 5px;
            border-right: 1px solid #000;
        }
        .eli-cell:last-child { border-right: none; }

        .eli-lbl { font-weight: 700; font-size: 10px; white-space: nowrap; text-transform: uppercase; }
        .eli-val { font-weight: 600; font-size: 11px; font-family: 'Roboto Mono', monospace; flex: 1; }
        .eli-val.fixed { font-family: Arial, sans-serif; font-size: 10px; font-weight: 700; }

        .eli-desc { padding: 6px; font-size: 11px; line-height: 1.3; overflow: hidden; }
        
        .eli-footer {
            border-top: 1px solid #000;
            padding: 6px;
            font-weight: 800;
            font-size: 12px;
            text-align: right;
            background: #f9f9f9;
        }

        /* Layout Numérico */
        .layout-numerica { border: 5px solid #000; height: 100%; display: flex; flex-direction: column; text-align: center; color: #000; }
        .num-header { background: #000; color: #fff; padding: 5px; height: 50px; display: flex; align-items: center; justify-content: center; }
        .num-header span { font-size: 32px; font-weight: 800; }
        .num-body { flex: 1; display: flex; align-items: center; justify-content: center; }
        .num-setor { font-size: 24px; font-weight: 800; text-transform: uppercase; }
        .num-footer { border-top: 4px solid #000; padding: 5px; font-weight: 700; background: #f0f0f0; }

        /* --- IMPRESSÃO --- */
        @media print {
            body { background: white; }
            .br-header, .control-panel, .br-footer, .btn-delete, .mode-switcher { display: none !important; }
            .main-container { display: block; margin: 0; padding: 0; max-width: none; }
            .preview-area { border: none; padding: 0; background: white; }
            .sheet-a4 {
                width: 210mm; height: 296mm; padding: 10mm; margin: 0; box-shadow: none;
                display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: repeat(3, 1fr);
                gap: 5mm; page-break-after: always;
            }
            .etiqueta-box { border: none !important; }
            
            /* Garante impressão de cores e bordas */
            .layout-eliminacao, .layout-numerica { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .eli-footer, .num-header { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        }
        
        @media (max-width: 900px) {
            .main-container { grid-template-columns: 1fr; }
            .sheet-a4 { transform: scale(0.6); transform-origin: top left; margin-bottom: -40%; }
        }
    </style>
</head>
<body>

    <header class="br-header">
        <div class="header-container">ARQUIVO / SEC</div>
    </header>

    <main class="main-container">
        <aside class="control-panel">
            <h2 class="panel-title"><i class="fas fa-tags"></i> Gerador de Etiquetas</h2>
            
            <div class="mode-switcher">
                <button class="mode-btn active" id="btnModeDoc" onclick="setModo('documental')">DOCUMENTAL</button>
                <button class="mode-btn" id="btnModeNum" onclick="setModo('numerica')">NUMÉRICA</button>
            </div>

            <div id="formDocumental">
                <div class="form-group">
                    <label class="form-label">Modelo</label>
                    <select id="docTipo" class="form-control" onchange="toggleCamposDoc()">
                        <option value="eliminacao">ELIMINAÇÃO (Padrão)</option>
                        <option value="permanente">GUARDA PERMANENTE</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Portador / Setor</label>
                    <input type="text" id="docPortador" class="form-control" placeholder="Busque pelo nº ou nome..." oninput="buscarSetor(this, 'listSetorDoc')" autocomplete="off">
                    <div id="listSetorDoc" class="autocomplete-list"></div>
                </div>

                <div class="row-2">
                    <div class="form-group">
                        <label class="form-label">Nº Doc.</label>
                        <input type="text" id="docNum" class="form-control">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Ano Doc.</label>
                        <input type="text" id="docAno" class="form-control" placeholder="AAAA">
                    </div>
                </div>

                <div class="row-2">
                    <div class="form-group">
                        <label class="form-label">Código</label>
                        <input type="text" id="docCodigo" class="form-control">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Tipo</label>
                        <input type="text" id="docTipoText" class="form-control">
                    </div>
                </div>

                <div class="row-2">
                    <div class="form-group">
                        <label class="form-label">Qtd (cm)</label>
                        <input type="number" id="docQtd" class="form-control">
                    </div>
                    <div class="form-group" id="groupAnoElim">
                        <label class="form-label" style="color: #cc0000;">Ano Eliminação</label>
                        <input type="text" id="docElim" class="form-control" placeholder="AAAA" style="border-color: #cc0000; color: #cc0000; font-weight: 700;">
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Descrição</label>
                    <textarea id="docDesc" class="form-control" placeholder="Resumo do conteúdo..."></textarea>
                </div>
            </div>

            <div id="formNumerica" style="display: none;">
                <div class="form-group">
                    <label class="form-label">Número da Caixa</label>
                    <input type="number" id="numCaixa" class="form-control" style="font-size: 24px; text-align: center; font-weight: 700;">
                </div>
                <div class="form-group">
                    <label class="form-label">Nome do Setor</label>
                    <input type="text" id="numSetor" class="form-control" oninput="buscarSetor(this, 'listSetorNum')" autocomplete="off">
                    <div id="listSetorNum" class="autocomplete-list"></div>
                </div>
                <div class="form-group">
                    <label class="form-label">Ano Referência</label>
                    <input type="text" id="numAno" class="form-control">
                </div>
            </div>

            <button class="btn btn-primary" onclick="adicionar()">
                <i class="fas fa-plus-circle"></i> Adicionar à Folha
            </button>
            <button class="btn btn-outline" onclick="preencherVazios()">
                <i class="fas fa-clone"></i> Preencher Vazios
            </button>
            
            <a href="index.html" class="btn btn-outline" style="text-decoration: none;">
                <i class="fas fa-arrow-left"></i> Voltar
            </a>

            <div style="border-top: 1px solid #eee; margin: 20px 0;"></div>

            <button class="btn btn-success" onclick="window.print()">
                <i class="fas fa-print"></i> Imprimir
            </button>
            <button class="btn btn-outline" style="color: #cc0000; border-color: #ffcccc;" onclick="limparTudo()">
                <i class="fas fa-trash"></i> Limpar Tudo
            </button>
        </aside>

        <section class="preview-area">
            <div id="folhaA4" class="sheet-a4">
                </div>
        </section>
    </main>

    <footer class="br-footer">
        © 2026 Desenvolvido por Vinicius A. de Souza com Claude.ai, Gemini e ChatGPT
    </footer>

    <script>
        // DADOS MOCK
        const BASE_SETORES = [
            {n:"1502 - GABINETE DO PREFEITO"}, {n:"1344 - SEC. MUNICIPAL DE EDUCAÇÃO"},
            {n:"1620 - RECURSOS HUMANOS"}, {n:"1805 - FINANÇAS / CONTABILIDADE"},
            {n:"1910 - CORPO DE BOMBEIROS"}, {n:"2100 - SAÚDE / ADMINISTRATIVO"},
            {n:"2250 - JURÍDICO"}, {n:"3010 - OBRAS E SERVIÇOS"}
        ];

        let etiquetas = [];
        const MAX_ETIQUETAS = 6; 

        function setModo(modo) {
            document.getElementById('btnModeDoc').className = modo === 'documental' ? 'mode-btn active' : 'mode-btn';
            document.getElementById('btnModeNum').className = modo === 'numerica' ? 'mode-btn active' : 'mode-btn';
            document.getElementById('formDocumental').style.display = modo === 'documental' ? 'block' : 'none';
            document.getElementById('formNumerica').style.display = modo === 'numerica' ? 'block' : 'none';
        }

        function toggleCamposDoc() {
            const tipo = document.getElementById('docTipo').value;
            const elimGroup = document.getElementById('groupAnoElim');
            elimGroup.style.visibility = (tipo === 'eliminacao') ? 'visible' : 'hidden';
        }

        function buscarSetor(input, listId) {
            const val = input.value.toUpperCase();
            const list = document.getElementById(listId);
            list.innerHTML = '';
            if (!val) { list.style.display = 'none'; return; }
            const matches = BASE_SETORES.filter(s => s.n.includes(val));
            if (matches.length > 0) {
                list.style.display = 'block';
                matches.forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'autocomplete-item';
                    div.innerText = item.n;
                    div.onclick = () => { input.value = item.n; list.style.display = 'none'; };
                    list.appendChild(div);
                });
            } else { list.style.display = 'none'; }
        }

        document.addEventListener('click', (e) => {
            if (!e.target.matches('input')) document.querySelectorAll('.autocomplete-list').forEach(el => el.style.display = 'none');
        });

        function adicionar() {
            if (etiquetas.length >= MAX_ETIQUETAS) { alert("Folha cheia!"); return; }
            const modo = document.getElementById('formNumerica').style.display === 'block' ? 'numerica' : 'documental';
            let data = {};

            if (modo === 'numerica') {
                data = { tipo: 'numerica', numero: document.getElementById('numCaixa').value || "00", setor: document.getElementById('numSetor').value || "GERAL", ano: document.getElementById('numAno').value || new Date().getFullYear() };
                document.getElementById('numCaixa').value = parseInt(data.numero) + 1;
            } else {
                data = {
                    tipo: document.getElementById('docTipo').value,
                    portador: document.getElementById('docPortador').value || "",
                    numDoc: document.getElementById('docNum').value || "",
                    anoDoc: document.getElementById('docAno').value || "",
                    codigo: document.getElementById('docCodigo').value || "",
                    tipoTexto: document.getElementById('docTipoText').value || "",
                    qtd: document.getElementById('docQtd').value || "",
                    desc: document.getElementById('docDesc').value || "",
                    elim: document.getElementById('docElim').value || ""
                };
            }
            etiquetas.push(data);
            renderizar();
        }

        function preencherVazios() {
            if (etiquetas.length === 0 || etiquetas.length >= MAX_ETIQUETAS) return;
            const modelo = etiquetas[etiquetas.length - 1];
            while (etiquetas.length < MAX_ETIQUETAS) {
                let novo = JSON.parse(JSON.stringify(modelo));
                if (novo.tipo === 'numerica') novo.numero = parseInt(novo.numero) + 1;
                etiquetas.push(novo);
            }
            renderizar();
        }

        function remover(idx) { etiquetas.splice(idx, 1); renderizar(); }
        function limparTudo() { etiquetas = []; renderizar(); }

        function renderizar() {
            const container = document.getElementById('folhaA4');
            container.innerHTML = '';

            etiquetas.forEach((et, idx) => {
                const box = document.createElement('div');
                box.className = 'etiqueta-box';
                const btnDel = `<button class="btn-delete" onclick="remover(${idx})"><i class="fas fa-times"></i></button>`;
                let html = '';

                if (et.tipo === 'eliminacao') {
                    // LAYOUT DE GRID PERFEITO
                    html = `
                        <div class="layout-eliminacao">
                            <div class="eli-row">
                                <div class="eli-cell" style="width: 60%;">
                                    <span class="eli-lbl">Nº DOC.:</span> <span class="eli-val">${et.numDoc}</span>
                                </div>
                                <div class="eli-cell" style="width: 40%;">
                                    <span class="eli-lbl">DATA:</span> <span class="eli-val">30/12/${et.anoDoc}</span>
                                </div>
                            </div>
                            <div class="eli-row">
                                <div class="eli-cell" style="width: 100%;">
                                    <span class="eli-lbl">PORTADOR:</span> <span class="eli-val">${et.portador}</span>
                                </div>
                            </div>
                            <div class="eli-row">
                                <div class="eli-cell" style="width: 100%;">
                                    <span class="eli-lbl">DESTINATÁRIO:</span> <span class="eli-val fixed">1344 – SEC. MUNICIPAL DE EDUCAÇÃO</span>
                                </div>
                            </div>
                            <div class="eli-row">
                                <div class="eli-cell" style="width: 50%;">
                                    <span class="eli-lbl">CÓDIGO:</span> <span class="eli-val">${et.codigo}</span>
                                </div>
                                <div class="eli-cell" style="width: 50%;">
                                    <span class="eli-lbl">SIT. DOC.:</span> <span class="eli-val fixed">AGUARDANDO PLANILHA</span>
                                </div>
                            </div>
                            <div class="eli-row">
                                <div class="eli-cell" style="width: 70%;">
                                    <span class="eli-lbl">TIPO:</span> <span class="eli-val">${et.tipoTexto}</span>
                                </div>
                                <div class="eli-cell" style="width: 30%;">
                                    <span class="eli-lbl">QTD:</span> <span class="eli-val">${et.qtd} cm</span>
                                </div>
                            </div>
                            <div class="eli-desc">
                                <span class="eli-lbl" style="display:block; margin-bottom:2px;">DESCRIÇÃO:</span>
                                ${et.desc}
                            </div>
                            <div class="eli-footer">
                                ELIMINAÇÃO: 31/12/${et.elim}
                            </div>
                        </div>
                    `;
                } else if (et.tipo === 'permanente') {
                    html = `
                        <div class="layout-eliminacao" style="border: 4px double #000;">
                            <div style="text-align:center; padding:5px; font-weight:800; border-bottom:2px solid #000;">GUARDA PERMANENTE</div>
                            <div class="eli-row"><div class="eli-cell" style="width:100%"><span class="eli-lbl">SETOR:</span> <span class="eli-val">${et.portador}</span></div></div>
                            <div class="eli-row"><div class="eli-cell" style="width:100%"><span class="eli-lbl">DOC:</span> <span class="eli-val">${et.numDoc} / ${et.anoDoc}</span></div></div>
                            <div class="eli-desc" style="flex:1"><span class="eli-lbl">CONTEÚDO:</span><br>${et.desc}</div>
                        </div>
                    `;
                } else if (et.tipo === 'numerica') {
                    html = `
                        <div class="layout-numerica">
                            <div class="num-header"><span>${et.numero}</span></div>
                            <div class="num-body"><div class="num-setor">${et.setor}</div></div>
                            <div class="num-footer">${et.ano}</div>
                        </div>
                    `;
                }

                box.innerHTML = btnDel + html;
                container.appendChild(box);
            });
        }
        
        toggleCamposDoc();
    </script>
</body>
</html>
